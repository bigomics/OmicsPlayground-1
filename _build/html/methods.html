<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Methods &mdash; Omics Playground  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/bigomics-logo-white-48px.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Frequently Asked Questions (FAQ)" href="faq.html" />
    <link rel="prev" title="Reanalyzing Public Datasets" href="examples/examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Omics Playground
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic Data Preparation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dataprep/dataprep.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/samples.html">Samples file</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/counts.html">Counts file</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/contrasts.html">Contrasts file (optional)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/datachecks.html">Checks before uploading</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/uploadopg.html">Uploading your data in Omics Playground</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Data Preparation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dataprep/computepgx.html">What if I have many datasets?</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/dataprep_example.html">Preparing input files from raw data formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/geneset.html">Loading custom geneset files</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataprep/dataprocess.html">Data processing inside Omics Playground</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules/outline.html">Outline</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod0_home.html">Home Panel</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod1_dataview.html">Data View</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod2_clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod3_DEGs.html">Expression</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod4_DEGSs.html">Enrichment</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod7_Signature.html">Signature</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/mod9_CellProfiling.html">Cell Profiling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/examples.html">Reanalyzing Public Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Methods</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#batch-correction">Batch correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clustering">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statistical-testing">Statistical testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functional-analysis">Functional analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scripting-and-visualization">Scripting and visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">REFERENCES</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="info.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.html#license">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Omics Playground</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Methods</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/methods.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="methods">
<span id="id1"></span><h1>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h1>
<p>Below are snippets that you can use to describe the methods when using
the Omics Playground. These are just examples and you need to extract
and modify the parts you used and need.</p>
<section id="batch-correction">
<h2>Batch correction<a class="headerlink" href="#batch-correction" title="Permalink to this headline">¶</a></h2>
<p>Batch effects, or contamination by unwanted variables, was identified
by an F-test for the first three principal components. Continuous
variables were dichotomized into high/low before testing. Highly
confounding variables would appear as having high relative
contribution in the first or second principal component, often higher
than the variable of interest. Batch effects were also visually
assessed (before and after correction) using annotated heatmaps and
t-SNE plots colored by variables.</p>
<p>[Setting: ‘low’] Batch correction was performed for explicit batch
variables or unwanted covariates. Parameters with a correlation r&gt;0.3
with any of variables of interest (i.e. the model parameters) were
omitted from the regression. Correction was performed by regressing
out the covariate using the ‘removeBatchEffect’ function in the limma
R/Bioconductor package.</p>
<p>[Setting: ‘medium’] Additional batch correction was performed for for
intrinsic technical parameters such as library size (i.e. total
counts), mitochondrial and ribosomal proportions, cell cycle and
gender. These parameters were estimated from the data. The cell cycle
was estimated using the Seurat R/Bioconductor package. Gender (if not
given) was estimated by checking the absence/presence of expression of
gender specific genes on the X/Y chromosome. Parameters with a
correlation r&gt;0.3 with any of the model parameters were omitted from
the regression. Correction was performed by regressing out the
covariate using the ‘removeBatchEffect’ function in the limma
R/Bioconductor package.</p>
<p>[Setting: ‘high’] Unsupervised batch correction was performed using
‘surrogate variable analysis’ (SVA) (Leek 2007) by estimating the
latent surrogate variables and regressing out using the
‘removeBatchEffect’ function in the limma R/Bioconductor package.</p>
</section>
<section id="clustering">
<h2>Clustering<a class="headerlink" href="#clustering" title="Permalink to this headline">¶</a></h2>
<p>Heatmaps were generated using the ComplexHeatmap R/Bioconductor
package (Gu 2016) on scaled log-expression values (z-score) using
euclidean distance and Ward linkage. The standard deviation was used
to rank the genes for the reduced heatmaps.</p>
<p>T-distributed stochastic neighbor embedding (t-SNE) was computed using
the top 1000 most varying genes, then reduced to 50 PCA dimensions
before computing the t-SNE embedding. The perplexity heuristically set
to 25% of the sample size or 30 at maximum, and 2 at
minimum. Calculation was performed using the <cite>Rtsne</cite> R package.</p>
<p>Uniform Manifold Approximation and Projection (UMAP) was computed
using the top 1000 most varying genes, then reduced to 50 PCA
dimensions before computing the UMAP embedding. The number of
neighbours was heuristically set to 25% of the sample size or 30 at
maximum, and 2 at minimum. Calculation was performed using the <cite>uwot</cite>
R package.</p>
<p>Principal component analysis (PCA) was computed using the <cite>irlba</cite> R
package.</p>
</section>
<section id="statistical-testing">
<h2>Statistical testing<a class="headerlink" href="#statistical-testing" title="Permalink to this headline">¶</a></h2>
<p>Multi-method statistical testing. For gene-level testing, statistical
significance was assessed using three independent statistical methods:
DESeq2 (Wald test), edgeR (QLF test) and limma-trend (Love 2014;
Robinson 2010; Ritchie 2015). The maximum q-value of the three methods
was taken as aggregate q-value, which corresponds to taking the
intersection of significant genes from all three tests.</p>
<p>Statistical testing of differential enrichment of genesets was
performed using an aggregation of multiple statistical methods:
Fisher’s exact test, fGSEA (Korotkevich 2019), Camera (Wu 2012) and
GSVA/limma (Hanzelmann 2013, Ritchie 2015). The maximum q-value of the
selected methods was taken as aggregate meta.q value, which
corresponds to taking the intersection of significant genes from all
tests. As each method uses different estimation parameters (NES for
GSEA, odd-ratio for fisher, etc.) for the effect size, for
consistency, we took the average log fold-change of the genes in the
geneset as sentinel value. We used more than 50000 genesets from
various public databases including: MSigDB (Subramanian 2005; Liberzon
2015), Gene Ontology (Ashburner 2000), and Kyoto Encyclopedia of Genes
and Genomes (KEGG) (Kanehisa 2000).</p>
</section>
<section id="functional-analysis">
<h2>Functional analysis<a class="headerlink" href="#functional-analysis" title="Permalink to this headline">¶</a></h2>
<p>Graph-weighted GO analysis. The enrichment score of a GO term was
defined as the sum of q-weighted average fold-changes, (1-q)*logFC, of
the GO term and all its higher order terms along the shortest path to
the root in the GO graph. The fold-change of a gene set was defined as
the average of the fold-change values of its member genes. This
graph-weighted enrichment score thus reflects the enrichment of a GO
term with evidence that is corroborated by its parents in the GO graph
and therefore provides a more robust estimate of enrichment. The
activation map visualizes the scores of the top-ranked GO terms for
multiple contrasts as a heatmap.</p>
<p>KEGG pathway visualization was performed using the Pathview
R/Bioconductor package using the foldchange as node color.</p>
</section>
<section id="scripting-and-visualization">
<h2>Scripting and visualization<a class="headerlink" href="#scripting-and-visualization" title="Permalink to this headline">¶</a></h2>
<p>Data preprocessing was performed using bespoke scripts using R (R Core
Team 2013) and packages from Bioconductor (Huber 2015). Statistical
computation and visualization have been performed using the Omics
Playground version vX.X.X (Akhmedov 2020).</p>
</section>
<section id="references">
<h2>REFERENCES<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Akhmedov M, Martinelli A, Geiger R and Kwee I. Omics Playground: A
comprehensive self-service platform forvisualization, analytics and
exploration of Big Omics Data. NAR Genomics and Bioinformatics, Volume
2, Issue 1, March 2020,</p>
<p>Ashburner et al. Gene ontology: tool for the unification of
biology. Nat Genet. May 2000;25(1):25-9.</p>
<p>Huber W, et al. (2015) Orchestrating high-throughput genomic analysis
with Bioconductor. Nature Methods 12:115-121; doi:10.1038/nmeth.3252</p>
<p>Kanehisa, M. and Goto, S.; KEGG: Kyoto Encyclopedia of Genes and
Genomes. Nucleic Acids Res. 28, 27-30 (2000).</p>
<p>Leek J., Storey J. Capturing heterogeneity in gene expression studies
by ‘surrogate variable analysis’ PLoS Genet. 2007</p>
<p>Love MI, Huber W, Anders S (2014). “Moderated estimation of fold
change and dispersion for RNA-seq data with DESeq2.” Genome Biology,
15, 550.</p>
<p>R Core Team (2013). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria.
URL <a class="reference external" href="http://www.R-project.org/">http://www.R-project.org/</a>.</p>
<p>Ritchie ME, Phipson B, Wu D, Hu Y, Law CW, Shi W, Smyth GK
(2015). “limma powers differential expression analyses for
RNA-sequencing and microarray studies.” Nucleic Acids Research, 43(7)</p>
<p>Robinson MD, McCarthy DJ, Smyth GK (2010). “edgeR: a Bioconductor
package for differential expression analysis of digital gene
expression data.” Bioinformatics, 26(1), 139-140.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples/examples.html" class="btn btn-neutral float-left" title="Reanalyzing Public Datasets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faq.html" class="btn btn-neutral float-right" title="Frequently Asked Questions (FAQ)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>